# 메모리 구조

### 코드 영역

프로그래머가 작성한 코드가 저장되는 메모리입니다.

### 데이터 영역

프로그램의 전역 변수와 정적 변수가 저장되는 영역입니다.
프로그램의 시작과 동시에 할당되고, 종료되면 소멸합니다.

- #### 전역 변수

  함수의 외부에서 선언된 변수를 의미합니다.
  프로그램의 어디에서나 접근할 수 있으며 데이터 영역의 소멸과 함께 소멸합니다. <br>다만 전역변수는 메모리를 차지하는 시간이 길기 때문에 자주 사용하는 것은 추천되지 않습니다.

- #### 정적 변수(static)
  정적 변수는 전역 변수와 지역 변수의 특성을 모두 가지는 변수입니다. 함수 내에서 선언하며 함수내에서만 사용 가능합니다.<br>
  아래와 같은 함수에서는 정적 변수를 사용하는 함수를 보여줍니다.<br>
  지역 변수라면 계속 cnt를 1로 초기화한 상태에서 함수가 진행되지만 static 변수는 한 번 초기화하고 계속 그 상태의 값을 함수에서 업데이트합니다.

```

int main(){
  for(int i = 0 ; i < 3; i++){
    static_func(); // 1 -> 2 -> 3
  }
  return 0;
}

void static_func(void){
  static int cnt  = 1;
  printf("%d\n", cnt);
  cnt++;
}

// 1
// 2
// 3
```

### 스택 영역

스택 영역은 함수 호출과 관계되는 지역 변수와 매개변수가 저장되는 영역입니다. 함수의 호출과 동시에 스택 영역에 할당되고 함수가 return하면 할당을 해제합니다.<br>
스택 영역은 자료구조의 스택과 마찬가지로 후입선출(LIFO)방식을 가지며 push를 통해 데이터를 저장하고 pop을 통해 데이터를 삭제합니다.
<br> 또한 저장되는 함수의 정보를 스택 프레임이라고 합니다.

#### 스택프레임

호출되는 함수와 관련되 데이터가 저장되는 영역입니다.<br> 즉 스택에 차례로 저장되는 함수의 호출 정보를 스택 프레임이라고 합니다.

#### 스택 오버플로우

재귀함수의 경우 혹은 함수내에서 다른 함수를 호출하는 경우에는 오버플로우에 유의해야합니다.<br>
스택에 스택프레임이 쌓이는 과정에서 제한된 스택 용량을 넘어서는 경우 프로그램이 강제 종료되는 상황이 발생합니다.
<br> 다만 저희가 하는 일반적인 프로젝트 프로그램의 경우에는 오버플로우가 발생할 상황이 드물긴합니다.<br>
저의 경우에는 아두이노를 조작하는 과정에서 메모리 문제가 자주 발생하는 경우가 있었는데 이 경우를 제외하고서는 한번도 본 적 없는 상황이긴 합니다.

### 힙

힙 영역은 사용자가 직접 관리하는 영역입니다.
<br> 간단하게 말하면 동적할당되는 데이터가 저장되는 부분입니다. 직접 관리라고 하면 어려울 수도 있지만 코드 상에서 제가 직접 할당하는 데이터다라는 개념으로 접근하면 좋을 것 같습니다.
malloc, new등이 이에 속합니다.
<br> 사용자가 관리한다는 것은 생성부터 삭제까지 사용자가 해야한다는 것과 같습니다.<br> c에서는 malloc을 통해 동적 할당한 변수가 있다면 free를 통해 삭제하는 과정을 거쳐야합니다. <br>생성만 하고 삭제를 안한다면 이 또한 오버플로우로 이어질 수 있습니다.
<br> 다만 자바, 자바스크립트 등의 언어에서는 자동으로 삭제하는 기능이 있습니다. 이에 대해서는 후술하겠습니다.

[참고] http://www.tcpschool.com/c/c_memory_structure

# Node.js의 메모리 구조

위의 메모리 구조는 가장 기본적인 C를 기준으로 서술했습니다. <br>저수준의 언어인 C와 달리 JS의 V8 엔진은 힙의 메모리를 시스템 상에서 자동으로 관리해주는 기능 등 사용자 친화적인 시스템을 지닌다고 보면 될거같습니다.

기본적으로는 스택과 힙은 위의 내용과 유사합니다.

### V8 엔진

V8 엔진이란 Google에서 만든 js 컴파일러로 C++기반으로 만들어진 오픈소스입니다.<br>

### V8 엔진의 메모리 구조
![메모리구조](https://github.com/twoo1999/BoostCampStudy/assets/125804293/8342796d-5736-415d-88b7-82483298f112)

